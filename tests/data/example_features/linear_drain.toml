#Example of a model that contains a drain#
###### Kinetic model ######
[[compartments]]
id = 'c'
name = 'cytosol'
volume = 1

[[compartments]]
id = 'e'
name = 'external'
volume = 1

[[metabolites]]
id = 'M1'
name = 'External metabolite number 1'
balanced = false
compartment = 'e'

[[metabolites]]
id = 'M2'
name = 'External metabolite number 2'
balanced = true
compartment = 'e'

[[metabolites]]
id = 'M1'
name = 'Metabolite number 1'
balanced = true
compartment = 'c'

[[metabolites]]
id = 'M2'
name = 'Metabolite number 2'
balanced = true
compartment = 'c'


[[reactions]]
id = 'r1'
name = 'reaction number 1'
stoichiometry = { M1_e = -1, M1_c = 1}
[[reactions.enzymes]]
id = 'r1'
name = 'the enzyme that catalyses reaction r1'
mechanism = 'modular_rate_law'

[[reactions]]
id = 'r2'
name = 'reaction number 2'
stoichiometry = { M1_c = -1, M2_c = 1 }
[[reactions.enzymes]]
id = 'r2'
name = 'the enzyme that catalyses reaction r2'
mechanism = 'modular_rate_law'

[[reactions]]
id = 'r3'
name = 'reaction number 3'
stoichiometry = { M2_c = -1, M2_e = 1}
[[reactions.enzymes]]
id = 'r3'
name = 'the enzyme that catalyses reaction r3'
mechanism = 'modular_rate_law'

[[drains]]
id = "M2_e_drain"
name = "drain of external M2"
stoichiometry = { M2_e = -1 }

###### Experimental data ######
[[experiments]]
id = 'condition_1'
metadata = ''
metabolite_measurements = [
  {target_id='M1_c', value=1.44218, uncertainty=0.1},
  {target_id='M2_c', value=1.43082, uncertainty=0.1},
  {target_id='M2_e', value=1.0, uncertainty=0.05},
]
reaction_measurements = [
  {target_id='r3', value=0.125573, uncertainty=0.01},
]
enzyme_measurements = [
]

[[priors.drains]]
drain_id = "M2_e_drain"
experiment_id = "condition_1"
location = 0.125573
scale = 0.01

[[priors.enzyme_concentrations]]
enzyme_id = 'r1'
experiment_id = 'condition_1'
location = 1
scale = 0.05


[[priors.enzyme_concentrations]]
enzyme_id = 'r2'
experiment_id = 'condition_1'
location = 1
scale = 0.05

[[priors.enzyme_concentrations]]
enzyme_id = 'r3'
experiment_id = 'condition_1'
location = 1
scale = 0.05

 
[[priors.unbalanced_metabolites]]
mic_id = 'M1_e'
experiment_id = 'condition_1'
location = 2
scale = 0.05


[[experiments]]
id = 'condition_2'
metadata = ''
metabolite_measurements = [
  {target_id='M1_c', value=1.66444, uncertainty=0.1},
  {target_id='M2_c', value=1.23255, uncertainty=0.1},
  {target_id='M2_e', value=1, uncertainty=0.05},
]
reaction_measurements = [
  {target_id='r3', value=0.107911, uncertainty=0.01},
]
enzyme_measurements = [
]

[[priors.drains]]
drain_id = "M2_e_drain"
experiment_id = "condition_2"
location = 0.107911
scale = 0.01


[[priors.enzyme_concentrations]]
enzyme_id = 'r1'
experiment_id = 'condition_2'
location = 1.5
scale = 0.05


[[priors.enzyme_concentrations]]
enzyme_id = 'r2'
experiment_id = 'condition_2'
location = 0.5
scale = 0.05

[[priors.enzyme_concentrations]]
enzyme_id = 'r3'
experiment_id = 'condition_2'
location = 1.5
scale = 0.05

[[priors.unbalanced_metabolites]]
mic_id = 'M1_e'
experiment_id = 'condition_2'
location = 2
scale = 0.05


###### Priors ######

[[priors.kcats]]
enzyme_id = "r1"
location = 1
scale = 0.6

[[priors.kcats]]
enzyme_id = "r2"
location = 1
scale = 0.6

[[priors.kcats]]
enzyme_id = "r3"
location = 1
scale = 0.6

[[priors.kms]]
enzyme_id = "r1"
mic_id = "M1_e"
location = 1
scale = 0.6

[[priors.kms]]
enzyme_id = "r1"
mic_id = "M1_c"
location = 1
scale = 0.6

[[priors.kms]]
enzyme_id = "r2"
mic_id = "M1_c"
location = 1
scale = 0.6

[[priors.kms]]
enzyme_id = "r2"
mic_id = "M2_c"
location = 1
scale = 0.6

[[priors.kms]]
enzyme_id = "r3"
mic_id = "M2_c"
location = 1
scale = 0.6

[[priors.kms]]
enzyme_id = "r3"
mic_id = "M2_e"
location = 1
scale = 0.6

[[priors.formation_energies]]
metabolite_id = "M1"
location = -1
scale = 0.05

[[priors.formation_energies]]
metabolite_id = "M2"
location = -2
scale = 0.05
